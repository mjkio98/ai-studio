<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Cache Busting: Force refresh of all static files -->
    <meta name="cache-control" content="no-cache, no-store, must-revalidate">
    <meta name="pragma" content="no-cache">
    <meta name="expires" content="0">
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VTSHZ6V3D1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-VTSHZ6V3D1');
    </script>
    
    <!-- SEO Meta Tags -->
    <title>{% block title %}AI Studio - AI-Powered Content Analysis Tool{% endblock %}</title>
    <meta name="description" content="AI Studio: Extract transcripts from videos, analyze webpages, and generate AI-powered summaries in Arabic and English. Fast, accurate, and free content analysis tool with multi-language support.">
    <meta name="keywords" content="AI Studio, video summary, AI summary, Arabic transcript, English transcript, content analysis, AI tools, transcript extractor, AI content analysis, webpage analysis">
    <meta name="author" content="AI Studio">
    <meta name="robots" content="index, follow">
    <meta name="language" content="en">
    
    <!-- Google Search Console Verification -->
    <meta name="google-site-verification" content="UQiAcERYgmfQLiOiVIKejz5h2zLAvuR_1rWgoAwb0lI">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="AI Studio - AI-Powered Content Analysis">
    <meta property="og:description" content="AI Studio: Extract transcripts from videos, analyze webpages, and generate AI-powered summaries in Arabic and English. Fast, accurate, and free.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://youtube-summarizer-jnp5egizua-uc.a.run.app">
    <meta property="og:image" content="https://youtube-summarizer-jnp5egizua-uc.a.run.app/static/images/og-image.jpg">
    <meta property="og:site_name" content="AI Studio">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="ar_SA">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AI Studio - AI-Powered Content Analysis">
    <meta name="twitter:description" content="AI Studio: Extract transcripts from videos, analyze webpages, and generate AI-powered summaries in Arabic and English.">
    <meta name="twitter:image" content="https://youtube-summarizer-jnp5egizua-uc.a.run.app/static/images/twitter-card.jpg">
    <meta name="twitter:creator" content="@AIStudio">
    
    <!-- Additional SEO Tags -->
    <meta name="theme-color" content="#e91e63">
    <meta name="msapplication-TileColor" content="#e91e63">
    <meta name="application-name" content="AI Studio">
    <link rel="canonical" href="https://youtube-summarizer-jnp5egizua-uc.a.run.app">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">
    
    <!-- Material Dashboard Theme Assets -->
    <link rel="apple-touch-icon" sizes="76x76" href="{{ url_for('static', filename='theme/assets/img/apple-icon.png') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='theme/assets/img/favicon.png') }}">
    
    <!-- Fonts and Icons -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Nucleo Icons -->
    <link href="{{ url_for('static', filename='theme/assets/css/nucleo-icons.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static', filename='theme/assets/css/nucleo-svg.css') }}" rel="stylesheet" />
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" crossorigin="anonymous">
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <!-- Material Dashboard CSS -->
    <link id="pagestyle" href="{{ url_for('static', filename='theme/assets/css/material-dashboard.css') }}?v=3.0.1" rel="stylesheet" />
    
    <!-- Custom YouTube App CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=2.1.0">
    
    <!-- Dashboard Integration CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard-integration.css') }}?v=2.1.0">
    
    <!-- Chat Agent CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat-agent-minimal.css') }}?v=1.0.0">
    
    <!-- Custom Header CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom-header.css') }}?v=1.0.0">
    
    <!-- Custom styles for integration -->
    <style>
        /* Custom integration styles */
        .youtube-content-wrapper {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .main-card {
            background: transparent;
            box-shadow: none;
            border: none;
            padding: 0;
        }
        
        .container {
            max-width: none;
            width: 100%;
            padding: 0;
        }
        
        /* Override some Material Dashboard styles for better integration */
        .sidenav .nav-link-text {
            font-size: 0.875rem;
        }
        
        /* Language switcher positioning */
        .language-switcher {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 10;
        }
        
        /* Remove sidebar scroll */
        .sidenav .navbar-collapse {
            max-height: none !important;
            overflow: visible !important;
        }
        
        .sidenav {
            height: auto !important;
            overflow: visible !important;
        }

        /* Mobile responsiveness for sidebar integration */
        @media (max-width: 1199px) {
            /* Hide sidebar on tablets and mobile - custom header takes over */
            .sidenav {
                display: none !important;
            }
            
            /* Adjust main content for tablets and mobile */
            .main-content {
                margin-left: 0 !important;
                padding-top: 0.25rem; /* Minimal spacing below custom header */
            }
            
            /* Ensure content has minimal spacing */
            .youtube-content-wrapper {
                margin-top: 0;
            }
            
            /* Hide desktop language switcher on tablets and mobile */
            .language-switcher {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 1rem;
                text-align: center;
            }
        }

        /* Mobile specific - reduce gap further */
        @media (max-width: 768px) {
            .main-content {
                padding-top: 0 !important;
            }
            
            .container-fluid.py-4 {
                padding-top: 0.75rem !important;
                padding-bottom: 1rem !important;
            }
        }

        /* Desktop adjustments - only for large screens */
        @media (min-width: 1200px) {
            /* Keep sidebar visible on large desktop */
            .sidenav {
                display: block !important;
            }
            
            /* Reset main content spacing for large desktop */
            .main-content {
                margin-top: 0;
                padding-top: 0;
            }
        }

        {% block extra_css %}{% endblock %}
    </style>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "YouTube Transcript & Summary",
        "description": "AI-powered tool to extract transcripts from YouTube videos and generate summaries in multiple languages",
        "url": "https://youtube-summarizer-jnp5egizua-uc.a.run.app",
        "applicationCategory": "Utility",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Organization",
            "name": "YouTube Summarizer"
        },
        "featureList": [
            "YouTube transcript extraction",
            "AI-powered video summaries", 
            "Arabic and English language support",
            "Multi-video synthesis",
            "Free to use"
        ]
    }
    </script>

    {% block extra_head %}{% endblock %}
</head>

<body class="g-sidenav-show bg-gray-200">
    <!-- Custom Header -->
    {% include 'components/custom_header.html' %}

    <!-- Sidebar Navigation -->
    <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3 bg-gradient-dark" id="sidenav-main">
        <div class="sidenav-header">
            <i class="fas fa-times p-3 cursor-pointer text-white opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
            <a class="navbar-brand m-0" href="/">
                <i class="fas fa-robot text-white" style="font-size: 2rem;"></i>
                <span class="ms-2 font-weight-bold text-white" data-en="AI Studio" data-ar="استوديو الذكاء الاصطناعي">AI Studio</span>
            </a>
        </div>
        <hr class="horizontal light mt-0 mb-2">
        <div class="collapse navbar-collapse w-auto max-height-vh-100" id="sidenav-collapse-main">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link text-white {% block nav_single_video_active %}{% endblock %}" href="/single-video" id="nav-single-video">
                        <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                            <i class="fas fa-play"></i>
                        </div>
                        <span class="nav-link-text ms-1" id="nav-single" data-en="Single Video" data-ar="فيديو واحد">Single Video</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white {% block nav_shorts_generator_active %}{% endblock %}" href="/shorts-generator" id="nav-shorts-generator">
                        <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                            <i class="fas fa-cut"></i>
                        </div>
                        <span class="nav-link-text ms-1" id="nav-shorts-text" data-en="Shorts Generator" data-ar="مولد الشورتس">Shorts Generator</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white {% block nav_chat_agent_active %}{% endblock %}" href="/chat-agent" id="nav-chat-agent">
                        <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                            <i class="fas fa-comments"></i>
                        </div>
                        <span class="nav-link-text ms-1" id="nav-chat-agent-text" data-en="Chat Agent" data-ar="وكيل المحادثة">Chat Agent</span>
                    </a>
                </li>
                <li class="nav-item mt-3">
                    <h6 class="ps-4 ms-2 text-uppercase text-xs text-white font-weight-bolder opacity-8" id="nav-general-header" data-en="AI Studio" data-ar="استوديو الذكاء الاصطناعي">AI Studio</h6>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white {% block nav_settings_active %}{% endblock %}" href="#" id="nav-about-btn">
                        <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                            <i class="fas fa-cog"></i>
                        </div>
                        <span class="nav-link-text ms-1" id="nav-about" data-en="Settings" data-ar="الإعدادات">Settings</span>
                    </a>
                </li>
            </ul>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg">
        <!-- Main Content Container -->
        {% block content %}{% endblock %}
    </main>

      <!-- Material Dashboard Core JS -->
    <script src="/static/theme/assets/js/core/popper.min.js"></script>
    <script src="/static/theme/assets/js/core/bootstrap.min.js"></script>
    <script src="/static/theme/assets/js/plugins/perfect-scrollbar.min.js"></script>
    <script src="/static/theme/assets/js/plugins/smooth-scrollbar.min.js"></script>
    <script src="/static/theme/assets/js/material-dashboard.min.js?v=3.0.1"></script>

    <!-- Page Detection Utility (Load First) -->
    <script src="{{ url_for('static', filename='js/page-detector.js') }}?v=2.1.0"></script>
    
    <!-- Custom Header JavaScript -->
    <script src="{{ url_for('static', filename='js/custom-header.js') }}?v=1.0.0"></script>
    
    <!-- Custom YouTube App JavaScript -->
    <script src="{{ url_for('static', filename='js/cache-manager.js') }}?v=2.1.0"></script>
    <script src="{{ url_for('static', filename='js/language-manager.js') }}?v=2.1.0"></script>
    <script src="{{ url_for('static', filename='js/ui-manager.js') }}?v=2.1.0"></script>
    <script src="{{ url_for('static', filename='js/streaming-manager.js') }}?v=2.1.0"></script>
    <script src="{{ url_for('static', filename='js/video-processor.js') }}?v=2.1.0"></script>
        <!-- Main Application -->
    <script src="{{ url_for('static', filename='js/main-app.js') }}?v=2.1.0"></script>
    
    <!-- Chat Agent -->
    <script src="{{ url_for('static', filename='js/chat-agent.js') }}?v=1761840382"></script>

    {% block javascript %}
    <!-- Additional Dashboard Integration Script -->
    <script>
        // Material Dashboard Integration
        document.addEventListener('DOMContentLoaded', function() {
            // Only run dashboard-specific scripts if we're on the dashboard page
            const isDashboardPage = document.getElementById('single-mode-btn') !== null;
            
            if (isDashboardPage) {
                // Sidebar navigation integration
                const navItems = document.querySelectorAll('.sidenav .nav-item .nav-link');
                const modeButtons = document.querySelectorAll('.btn-mode');
                
                // Handle sidebar navigation clicks - Let them navigate to actual pages
                const navSingleVideo = document.getElementById('nav-single-video');
                if (navSingleVideo) {
                    // Remove any existing event listeners and let normal navigation happen
                    // This allows proper URL changes to /single-video
                }
                
                const navWebpage = document.getElementById('nav-webpage');
                if (navWebpage) {
                    // Remove any existing event listeners and let normal navigation happen
                    // This allows proper URL changes to /webpage-analysis
                }
                
                function updateActiveNav(activeId) {
                    navItems.forEach(nav => {
                        nav.classList.remove('active', 'bg-gradient-primary');
                        nav.classList.add('text-white');
                    });
                    const activeNav = document.getElementById(activeId);
                    if (activeNav) {
                        activeNav.classList.add('active', 'bg-gradient-primary');
                    }
                }
                
                // Handle Video Analyzer general click
                const navVideoAnalyzer = document.getElementById('nav-video-analyzer');
                if (navVideoAnalyzer) {
                    navVideoAnalyzer.addEventListener('click', function(e) {
                        // Only prevent default if we're on the dashboard page
                        if (isDashboardPage) {
                            e.preventDefault();
                            // Show mode buttons when general video analyzer is clicked
                            const modeButtons = document.querySelector('.mode-buttons');
                            if (modeButtons) modeButtons.style.display = 'flex';
                            updateActiveNav('nav-video-analyzer');
                        }
                        // On other pages, let the normal navigation happen
                    });
                }

                // Handle mode button clicks to update sidebar
                modeButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // Remove active class from all mode buttons
                        modeButtons.forEach(btn => btn.classList.remove('active'));
                        // Add active class to clicked button
                        this.classList.add('active');
                        
                        let navId;
                        if (this.id === 'single-mode-btn') navId = 'nav-single-video';
                        else if (this.id === 'shorts-mode-btn') navId = 'nav-video-analyzer'; // Shorts stays under Content
                        else if (this.id === 'webpage-mode-btn') navId = 'nav-webpage';
                        else if (this.id === 'chat-agent-mode-btn') navId = 'nav-chat-agent';
                        
                        if (navId) updateActiveNav(navId);
                        
                        // Show mode buttons when clicking any mode button
                        const modeButtons = document.querySelector('.mode-buttons');
                        if (modeButtons) modeButtons.style.display = 'flex';
                        
                        // Handle section switching with safety checks
                        const sections = [
                            'single-video-section', 'shorts-generation-section', 
                            'webpage-section', 'chat-agent-section'
                        ];
                        
                        sections.forEach(sectionId => {
                            const section = document.getElementById(sectionId);
                            if (section) section.classList.add('hidden');
                        });
                        
                        if (this.id === 'single-mode-btn') {
                            const section = document.getElementById('single-video-section');
                            if (section) section.classList.remove('hidden');
                        } else if (this.id === 'shorts-mode-btn') {
                            const section = document.getElementById('shorts-generation-section');
                            if (section) section.classList.remove('hidden');
                        } else if (this.id === 'webpage-mode-btn') {
                            const section = document.getElementById('webpage-section');
                            if (section) section.classList.remove('hidden');
                        } else if (this.id === 'chat-agent-mode-btn') {
                            const section = document.getElementById('chat-agent-section');
                            if (section) section.classList.remove('hidden');
                        }
                        
                        // Hide results sections when switching modes
                        const summarySection = document.getElementById('summary-section');
                        const shortsSection = document.getElementById('shorts-clips-section');
                        if (summarySection) summarySection.classList.add('hidden');
                        if (shortsSection) shortsSection.classList.add('hidden');
                    });
                });
                
                // NOTE: Generate Shorts button handler moved to dashboard.html
                // to support client-side processing
                
                // Only initialize dashboard-specific features if we're on dashboard
                if (isDashboardPage) {
                    // Initialize with Content section active and show mode buttons
                    updateActiveNav('nav-video-analyzer');
                    const modeButtonsEl = document.querySelector('.mode-buttons');
                    if (modeButtonsEl) modeButtonsEl.style.display = 'flex';
                    
                    // Set default mode to single video
                    const singleModeBtn = document.getElementById('single-mode-btn');
                    const singleVideoSection = document.getElementById('single-video-section');
                    if (singleModeBtn) singleModeBtn.classList.add('active');
                    if (singleVideoSection) singleVideoSection.classList.remove('hidden');
                    
                    // Hide unwanted options when Content section is active
                    function hideUnwantedContentOptions() {
                        // Hide Video Summary and Webpage Analysis buttons
                        const singleModeBtn = document.getElementById('single-mode-btn');
                        const webpageModeBtn = document.getElementById('webpage-mode-btn');
                        const shortsModeBtn = document.getElementById('shorts-mode-btn');
                        
                        if (singleModeBtn) singleModeBtn.style.display = 'none';
                        if (webpageModeBtn) webpageModeBtn.style.display = 'none';
                        
                        // Show only Shorts Generator and make it active
                        if (shortsModeBtn) {
                            shortsModeBtn.style.display = 'block';
                            shortsModeBtn.classList.add('active');
                        }
                        
                        // Hide corresponding sections
                        const singleVideoSection = document.getElementById('single-video-section');
                        const webpageSection = document.getElementById('webpage-section');
                        const shortsSection = document.getElementById('shorts-generation-section');
                        
                        if (singleVideoSection) singleVideoSection.classList.add('hidden');
                        if (webpageSection) webpageSection.classList.add('hidden');
                        
                        // Show shorts section
                        if (shortsSection) shortsSection.classList.remove('hidden');
                    }
                    
                    // Apply the hiding when Content nav is clicked
                    const contentNavBtn = document.getElementById('nav-video-analyzer');
                    if (contentNavBtn) {
                        contentNavBtn.addEventListener('click', function() {
                            if (isDashboardPage) {
                                hideUnwantedContentOptions();
                            }
                        });
                    }
                    
                    // Apply on initial load if Content is active
                    hideUnwantedContentOptions();
                }
            } else {
                // For non-dashboard pages, just handle basic sidebar navigation
                console.log('Non-dashboard page detected, loading minimal navigation');
            }
        });
    </script>
    {% endblock %}

    {% block extra_js %}{% endblock %}

    <!-- Client-Side Video Processing Scripts -->
    {% include 'includes/client_side_scripts.html' %}
</body>
</html>
